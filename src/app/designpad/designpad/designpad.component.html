<div class="flex h-full relative">
  <div
    class="w-32 gap-4 p-4 flex flex-col items-center justify-start h-full bg-gradient-to-r from-gray-300 to-gray-200 shadow-xl">
    <button
      [class]="activeTool === 'MoveTool' ? 'border-yellow-600' : 'border-gray-400'"
      class="w-20 h-20 bg-transparent border-2 flex flex-col items-center justify-center outline-none focus:outline-none"
      (click)="activateTool('MoveTool')">
      <svg aria-hidden="true" class="w-6 h-6 text-black" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512">
        <path fill="currentColor"
              d="M448 344v112a23.94 23.94 0 01-24 24H312c-21.39 0-32.09-25.9-17-41l36.2-36.2L224 295.6 116.77 402.9 153 439c15.09 15.1 4.39 41-17 41H24a23.94 23.94 0 01-24-24V344c0-21.4 25.89-32.1 41-17l36.19 36.2L184.46 256 77.18 148.7 41 185c-15.1 15.1-41 4.4-41-17V56a23.94 23.94 0 0124-24h112c21.39 0 32.09 25.9 17 41l-36.2 36.2L224 216.4l107.23-107.3L295 73c-15.09-15.1-4.39-41 17-41h112a23.94 23.94 0 0124 24v112c0 21.4-25.89 32.1-41 17l-36.19-36.2L263.54 256l107.28 107.3L407 327.1c15.1-15.2 41-4.5 41 16.9z"/>
      </svg>
      <span class="text-xs uppercase mt-2">Move</span>
    </button>
    <button
      [class]="activeTool === 'SelectTool' ? 'border-yellow-600' : 'border-gray-400'"
      class="w-20 h-20 bg-transparent border-2  flex flex-col items-center justify-center outline-none focus:outline-none"
      (click)="activateTool('SelectTool')">
      <svg aria-hidden="true" class="w-6 h-6 text-black" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 320 512">
        <path fill="currentColor"
              d="M302.189 329.126H196.105l55.831 135.993c3.889 9.428-.555 19.999-9.444 23.999l-49.165 21.427c-9.165 4-19.443-.571-23.332-9.714l-53.053-129.136-86.664 89.138C18.729 472.71 0 463.554 0 447.977V18.299C0 1.899 19.921-6.096 30.277 5.443l284.412 292.542c11.472 11.179 3.007 31.141-12.5 31.141z"/>
      </svg>
      <span class="text-xs uppercase mt-2">Select</span>
    </button>
    <button
      [class.hidden]="activeComponent.type === 1"
      [class]="activeTool === 'AddComponentTool' ? 'border-yellow-600' : 'border-gray-400'"
      class="w-20 h-20 bg-transparent border-2 flex flex-col items-center justify-center outline-none focus:outline-none"
      (click)="activateTool('AddComponentTool')">
      <svg aria-hidden="true" class="w-6 h-6 text-black" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 640 512">
        <path fill="currentColor"
              d="M368 32h-96c-17.67 0-32 14.33-32 32v96c0 17.67 14.33 32 32 32h96c17.67 0 32-14.33 32-32V64c0-17.67-14.33-32-32-32zM208 88h-84.75C113.75 64.56 90.84 48 64 48 28.66 48 0 76.65 0 112s28.66 64 64 64c26.84 0 49.75-16.56 59.25-40h79.73c-55.37 32.52-95.86 87.32-109.54 152h49.4c11.3-41.61 36.77-77.21 71.04-101.56-3.7-8.08-5.88-16.99-5.88-26.44V88zm-48 232H64c-17.67 0-32 14.33-32 32v96c0 17.67 14.33 32 32 32h96c17.67 0 32-14.33 32-32v-96c0-17.67-14.33-32-32-32zM576 48c-26.84 0-49.75 16.56-59.25 40H432v72c0 9.45-2.19 18.36-5.88 26.44 34.27 24.35 59.74 59.95 71.04 101.56h49.4c-13.68-64.68-54.17-119.48-109.54-152h79.73c9.5 23.44 32.41 40 59.25 40 35.34 0 64-28.65 64-64s-28.66-64-64-64zm0 272h-96c-17.67 0-32 14.33-32 32v96c0 17.67 14.33 32 32 32h96c17.67 0 32-14.33 32-32v-96c0-17.67-14.33-32-32-32z"/>
      </svg>
      <span class="text-xs uppercase mt-2">Add Component</span>
    </button>
    <button
      [class.hidden]="activeComponent.type !== 1"
      [class]="activeTool === 'AddStateTool' ? 'border-yellow-600' : 'border-gray-400'"
      class="w-20 h-20 bg-transparent border-2 flex flex-col items-center justify-center outline-none focus:outline-none"
      (click)="activateTool('AddStateTool')">
      <svg aria-hidden="true" class="w-6 h-6 text-black" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512">
        <path fill="currentColor"
              d="M400 32H48C21.5 32 0 53.5 0 80v352c0 26.5 21.5 48 48 48h352c26.5 0 48-21.5 48-48V80c0-26.5-21.5-48-48-48z"/>
      </svg>
      <span class="text-xs uppercase mt-2">New State</span>
    </button>
    <button
      [class.hidden]="activeComponent.type !== 1"
      [class]="activeTool === 'AddTransitionTool' ? 'border-yellow-600' : 'border-gray-400'"
      class="w-20 h-20 bg-transparent border-2  flex flex-col items-center justify-center outline-none focus:outline-none"
      (click)="activateTool('AddTransitionTool')">
      <svg aria-hidden="true" class="w-6 h-6 text-black" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512">
        <path fill="currentColor"
              d="M313.941 216H12c-6.627 0-12 5.373-12 12v56c0 6.627 5.373 12 12 12h301.941v46.059c0 21.382 25.851 32.09 40.971 16.971l86.059-86.059c9.373-9.373 9.373-24.569 0-33.941l-86.059-86.059c-15.119-15.119-40.971-4.411-40.971 16.971V216z"/>
      </svg>
      <span class="text-xs uppercase mt-2">New Transition</span>
    </button>
    <button
      [class.hidden]="activeComponent.type !== 1"
      [class]="activeTool === 'ResizeStateTool' ? 'border-yellow-600' : 'border-gray-400'"
      class="w-20 h-20 bg-transparent border-2  flex flex-col items-center justify-center outline-none focus:outline-none"
      (click)="activateTool('ResizeStateTool')">
      <svg aria-hidden="true" class="w-6 h-6 text-black" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512">
        <path fill="currentColor"
              d="M0 180V56c0-13.3 10.7-24 24-24h124c6.6 0 12 5.4 12 12v40c0 6.6-5.4 12-12 12H64v84c0 6.6-5.4 12-12 12H12c-6.6 0-12-5.4-12-12zM288 44v40c0 6.6 5.4 12 12 12h84v84c0 6.6 5.4 12 12 12h40c6.6 0 12-5.4 12-12V56c0-13.3-10.7-24-24-24H300c-6.6 0-12 5.4-12 12zm148 276h-40c-6.6 0-12 5.4-12 12v84h-84c-6.6 0-12 5.4-12 12v40c0 6.6 5.4 12 12 12h124c13.3 0 24-10.7 24-24V332c0-6.6-5.4-12-12-12zM160 468v-40c0-6.6-5.4-12-12-12H64v-84c0-6.6-5.4-12-12-12H12c-6.6 0-12 5.4-12 12v124c0 13.3 10.7 24 24 24h124c6.6 0 12-5.4 12-12z"></path>
      </svg>
      <span class="text-xs uppercase mt-2">Resize State</span>
    </button>
    <button [class]="activeTool === 'SimulatorTool' ? 'border-yellow-600' : 'border-gray-400'"
            class="w-20 h-20 bg-transparent border-2  flex flex-col items-center justify-center outline-none focus:outline-none"
            (click)="activateSimulator()">
      <svg aria-hidden="true" class="w-6 h-6 text-black" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512">
        <path fill="currentColor"
              d="M424.4 214.7L72.4 6.6C43.8-10.3 0 6.1 0 47.9V464c0 37.5 40.7 60.1 72.4 41.3l352-208c31.4-18.5 31.5-64.1 0-82.6z"/>
      </svg>
      <span class="text-xs uppercase mt-2">Simulator</span>
    </button>
    <button
      class="w-20 h-20 bg-transparent border-2 border-gray-400 flex flex-col items-center justify-center outline-none focus:outline-none"
      (click)="save()">
      <svg aria-hidden="true" class="w-6 h-6 text-black" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512">
        <path fill="currentColor"
              d="M433.941 129.941l-83.882-83.882A48 48 0 00316.118 32H48C21.49 32 0 53.49 0 80v352c0 26.51 21.49 48 48 48h352c26.51 0 48-21.49 48-48V163.882a48 48 0 00-14.059-33.941zM224 416c-35.346 0-64-28.654-64-64 0-35.346 28.654-64 64-64s64 28.654 64 64c0 35.346-28.654 64-64 64zm96-304.52V212c0 6.627-5.373 12-12 12H76c-6.627 0-12-5.373-12-12V108c0-6.627 5.373-12 12-12h228.52c3.183 0 6.235 1.264 8.485 3.515l3.48 3.48A11.996 11.996 0 01320 111.48z"/>
      </svg>
      <span class="text-xs uppercase mt-2">Save</span>
    </button>
    <div>
      <app-model-checker [component]="activeComponent"></app-model-checker>
    </div>
  </div>
  <div class="w-full flex flex-col h-full overflow-y-auto p-4">
    <div class="w-full flex flex-row gap-2 mb-4">
      <div class="w-1/3">
        <label for="label" class="block text-sm font-medium text-gray-700">Label</label>
        <div class="mt-1">
          <input [readOnly]="activeTool === 'SimulatorTool'" type="text" name="label" id="label"
                 class="w-full shadow-sm focus:ring-indigo-500 focus:border-indigo-500
                 sm:text-sm border-gray-300 rounded-md" (keypress)="updateValue($event)"
                 [(ngModel)]="tempComponentLabel">
        </div>
      </div>
      <div class="w-1/3" *ngIf="activeComponent.type === 1">
        <label for="initialState" class="block text-sm font-medium text-gray-700">Initial state</label>
        <div class="mt-1">
          <select name="initialState" id="initialState" (change)="updateInitialValue($event.target.value)"
                  class="w-full block w-full pl-3 pr-10 py-2 text-base border-gray-300 focus:outline-none focus:ring-indigo-500 focus:border-indigo-500 sm:text-sm rounded-md">
            <option *ngFor="let event of activeComponent.states | keyvalue" value="{{event.value.label}}"
                    [selected]="event.value.label == activeComponent.initialState.label">{{event.value.label}}</option>
          </select>
        </div>
      </div>
    </div>
    <div class="flex h-full">
      <div class="w-1/5 flex flex-col justify-between py-3 overflow-hidden">
        <div class="flex flex-col overflow-y-auto h-full">
          <div *ngFor="let label of activeComponent.inputs"
               (mousedown)="onMouseDownAction($event, label, false)"
               (dblclick)="onDoubleClickAction(label)"
               (keydown)="onKeyDownAction($event, false)"
               class="flex flex-col justify-center items-center w-full">
            <input *ngIf="selectedRenameAction === label" type="text"
                   [(ngModel)]="tempActionName">
            <h3 *ngIf="selectedRenameAction !== label">{{label}}?</h3>
            <svg class="-mt-3" xmlns="http://www.w3.org/2000/svg" viewBox="0 -5 110 10">
              <defs>
                <marker id='head' orient='auto' markerWidth='2' markerHeight='4'
                        refX='0.1' refY='2'>
                  <path d='M0,0 V4 L2,2 Z' fill='black'/>
                </marker>
              </defs>
              <line marker-end="url(#head)"
                    stroke-width="2" fill="none" stroke="black"
                    x1="0" x2="100" y1="0" y2="0"></line>
            </svg>
          </div>
        </div>
        <div  *ngIf="activeComponent.type != 3" [class.hidden]="activeTool === 'SimulatorTool'" class="h-16">
          <input #newInputEvent type="text">
          <button (click)="addNewInput(newInputEvent.value); newInputEvent.value = ''">Add new Input</button>
        </div>
      </div>
      <div #designPadWrapper class="border-4 border-black rounded-lg h-full select-none w-3/5">
        <app-pad-controller [simulatorTraceSubject]="simulatorTrance" [(activeTool)]="activeTool"
                            [component]="activeComponent" [parent]="designPadWrapper"></app-pad-controller>
      </div>
      <div class="w-1/5 flex flex-col justify-between py-3 overflow-hidden">
        <div class="flex flex-col overflow-y-auto h-full">
          <div *ngFor="let label of activeComponent.outputs"
               (mousedown)="onMouseDownAction($event, label, true)"
               (dblclick)="onDoubleClickAction(label)"
               (keydown)="onKeyDownAction($event, true)"
               class="flex flex-col justify-center items-center w-full">
            <input *ngIf="selectedRenameAction === label" type="text"
                  [(ngModel)]="tempActionName">
            <h3 *ngIf="selectedRenameAction !== label">{{label}}!</h3>
            <svg class="-mt-3" xmlns="http://www.w3.org/2000/svg" viewBox="0 -5 110 10">
              <defs>
                <marker id='head' orient='auto' markerWidth='2' markerHeight='4'
                        refX='0.1' refY='2'>
                  <path d='M0,0 V4 L2,2 Z' fill='black'/>
                </marker>
              </defs>
              <line marker-end="url(#head)"
                    stroke-width="2" fill="none" stroke="black"
                    x1="0" x2="100" y1="0" y2="0"></line>
            </svg>
          </div>
        </div>
        <div *ngIf="activeComponent.type != 3"  [class.hidden]="activeTool === 'SimulatorTool'" class="h-16">
          <input #newOutputEvent type="text">
          <button (click)="addNewOutput(newOutputEvent.value); newOutputEvent.value = ''">Add new Output</button>
        </div>
      </div>
      <div class="w-1/3 ml-4" *ngIf="activeTool === 'SimulatorTool'">
        <app-simulator-trace [simulatorTrances]="simulatorTrance | async"></app-simulator-trace>
      </div>
    </div>
  </div>
</div>
